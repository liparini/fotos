<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Galeria de Fotos e Vídeos - Visitantes</title>
<style>
body{
  margin:0;
  font-family:system-ui;
  background:#0f172a;
  color:#e5e7eb;
}
h1{text-align:center;margin:20px 0;}
#filtroContainer{
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  gap:10px;
  margin-bottom:16px;
  padding:0 16px;
}
#filtroNome{
  padding:8px;
  border-radius:8px;
  border:1px solid #233053;
  background:#0b1220;
  color:#e5e7eb;
  min-width:200px;
  flex:1;
}
.gallery{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(180px,1fr));
  gap:16px;
  padding:16px;
}
.card{
  background:linear-gradient(180deg,#0f1628,#0c1424);
  border:1px solid #1f2a44;
  border-radius:16px;
  overflow:hidden;
  text-align:center;
  cursor:pointer;
  position:relative;
}
.card img, .card video{
  width:100%;
  aspect-ratio:4/3;
  object-fit:cover;
  display:block;
}
.download-btn{
  display:inline-block;
  margin:8px 0;
  padding:4px 8px;
  background:#22c55e;
  color:#0b1220;
  border-radius:8px;
  text-decoration:none;
  font-size:12px;
  transition:.2s;
}
.download-btn:hover{filter:brightness(1.1);}
.muted{font-size:12px;color:#94a3b8;}

/* Modal */
#mediaModal{
  display:none;
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:rgba(0,0,0,.85);
  justify-content:center;
  align-items:center;
  z-index:9999;
  flex-direction:column;
}
#mediaModal img, #mediaModal video{
  max-width:90%;
  max-height:80%;
  border-radius:12px;
  box-shadow:0 8px 32px rgba(0,0,0,.7);
}
#mediaModal span{
  position:absolute;
  top:20px;
  right:30px;
  font-size:28px;
  color:#fff;
  cursor:pointer;
}
#mediaModal div{
  color:#fff;
  margin-top:8px;
  font-size:14px;
  text-align:center;
}
</style>
</head>
<body>
<h1>Galeria de Fotos e Vídeos dos Visitantes</h1>

<div id="filtroContainer">
  <input type="text" id="filtroNome" placeholder="Buscar pelo nome do visitante...">
</div>

<div id="gallery" class="gallery"></div>

<!-- Modal -->
<div id="mediaModal">
  <span id="closeModal">&times;</span>
  <img id="modalImg" style="display:none" alt="Foto">
  <video id="modalVideo" style="display:none" controls></video>
  <div id="modalInfo"></div>
  <a id="modalDownload" href="#" download class="download-btn">Baixar</a>
</div>

<script>
// ⚙️ Configuração do seu GitHub
const usuario = "liparini";      // seu usuário
const repositorio = "fotos";     // seu repositório
const pasta = "fotos";           // pasta com as imagens/vídeos

async function carregarMidia() {
  const url = `https://api.github.com/repos/${usuario}/${repositorio}/contents/${pasta}`;
  const resposta = await fetch(url);
  const arquivos = await resposta.json();

  const gallery = document.getElementById("gallery");
  const filtroNome = document.getElementById("filtroNome").value.toLowerCase();
  gallery.innerHTML = "";

  arquivos.filter(a => a.type === "file" && a.name.match(/\.(jpg|jpeg|png|gif|mp4|webm|ogg)$/i))
          .filter(a => a.name.toLowerCase().includes(filtroNome))
          .forEach(arquivo => {
            const url = encodeURI(arquivo.download_url);
            const nome = arquivo.name.replace(/\.(jpg|jpeg|png|gif|mp4|webm|ogg)$/i,"");
            
            const card = document.createElement("div");
            card.className = "card";

            if(/\.(mp4|webm|ogg)$/i.test(arquivo.name)){
              card.innerHTML = `
                <video src="${url}" muted></video>
                <div>${nome} (vídeo)</div>
              `;
              card.onclick = () => abrirModal("video", url, nome);
            } else {
              card.innerHTML = `
                <img src="${url}" alt="${nome}">
                <div>${nome}</div>
              `;
              card.onclick = () => abrirModal("img", url, nome);
            }
            gallery.appendChild(card);
          });
}

// Modal
const modal = document.getElementById("mediaModal");
const modalImg = document.getElementById("modalImg");
const modalVideo = document.getElementById("modalVideo");
const modalInfo = document.getElementById("modalInfo");
const modalDownload = document.getElementById("modalDownload");

document.getElementById("closeModal").onclick = () => fecharModal();
modal.onclick = e => { if(e.target === modal) fecharModal(); }

function abrirModal(tipo, url, nome){
  modal.style.display='flex';
  if(tipo==="img"){
    modalImg.style.display="block";
    modalVideo.style.display="none";
    modalImg.src = url;
  } else {
    modalVideo.style.display="block";
    modalImg.style.display="none";
    modalVideo.src = url;
  }
  modalInfo.textContent = nome;
  modalDownload.href = url;
}

function fecharModal(){
  modal.style.display='none';
  modalVideo.pause();
  modalVideo.src="";
}

// Eventos
document.getElementById("filtroNome").addEventListener("input", carregarMidia);

// Inicialização
carregarMidia();
</script>
</body>
</html>
